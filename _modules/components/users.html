

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>components.users &mdash; Algo-segregation 0.1.0b documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Algo-segregation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/reference.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Algo-segregation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>components.users</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for components.users</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">rec.utils</span> <span class="kn">import</span> <span class="n">VerboseMode</span><span class="p">,</span> <span class="n">normalize_matrix</span>
<span class="kn">from</span> <span class="nn">rec.random</span> <span class="kn">import</span> <span class="n">Generator</span>
<span class="kn">from</span> <span class="nn">.base_components</span> <span class="kn">import</span> <span class="n">Component</span><span class="p">,</span> <span class="n">FromNdArray</span><span class="p">,</span> <span class="n">BaseComponent</span>


<div class="viewcode-block" id="PredictedScores"><a class="viewcode-back" href="../../reference/components.html#components.users.PredictedScores">[docs]</a><span class="k">class</span> <span class="nc">PredictedScores</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User scores about items generated by the model. This class is a container compatible with Numpy operations and it does not make assumptions on the size of the representation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicted_scores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;predicted_user_scores&#39;</span>
        <span class="n">Component</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_state</span><span class="o">=</span><span class="n">predicted_scores</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>


<div class="viewcode-block" id="PredictedUserProfiles"><a class="viewcode-back" href="../../reference/components.html#components.users.PredictedUserProfiles">[docs]</a><span class="k">class</span> <span class="nc">PredictedUserProfiles</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    User profiles as predicted by the model. This class is a container compatible with Numpy operations and it does not make assumptions on the size of the representation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_profiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;predicted_user_profiles&#39;</span>
        <span class="n">Component</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_state</span><span class="o">=</span><span class="n">user_profiles</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span></div>

<div class="viewcode-block" id="ActualUserProfiles"><a class="viewcode-back" href="../../reference/components.html#components.users.ActualUserProfiles">[docs]</a><span class="k">class</span> <span class="nc">ActualUserProfiles</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Real user profiles, unknown to the model. This class is a container compatible with Numpy operations and it does not make assumptions on the size of the representation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_profiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;actual_user_profiles&#39;</span>
        <span class="n">Component</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_state</span><span class="o">=</span><span class="n">user_profiles</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span></div>

<div class="viewcode-block" id="Users"><a class="viewcode-back" href="../../reference/components.html#components.users.Users">[docs]</a><span class="k">class</span> <span class="nc">Users</span><span class="p">(</span><span class="n">BaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing users in the system.</span>

<span class="sd">    This class contains the real user preferences, which are unknown to the system, and the behavior of users when interacting with items.</span>

<span class="sd">    In general, users are represented with single *array_like* objects that contain all the users&#39; preferences and characteristics. For example, real user preferences can be represented by a Numpy ndarray of size `(number_of_users, number_of_items)` where element `[u,i]` is the score assigned by user u to item i.</span>

<span class="sd">    Models determine the size constraints of objects representing users. Requirements vary across models and, unless specified, this class does not make assumptions on the real user components.</span>

<span class="sd">    This class inherits from :class:`~components.base_components.BaseComponent`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------</span>

<span class="sd">        actual_user_profiles: array_like or None (optional, default: None)</span>
<span class="sd">            Representation of the real user profiles.</span>

<span class="sd">        actual_user_scores: array_like or None (optional, default: None)</span>
<span class="sd">            Representation of the real scores that users assign to items.</span>

<span class="sd">        interact_with_items: callable or None (optional, default: None)</span>
<span class="sd">            Function that specifies the behavior of users when interacting with items. If None, users follow the behavior specified in :meth:`get_user_feedback()`.</span>

<span class="sd">        num_users: int or None, (optional, default: None)</span>
<span class="sd">            The number of users in the system.</span>

<span class="sd">        size: tuple, None (optional, default: None)</span>
<span class="sd">            Size of the user representation. It expects a tuple. If None, it is chosen randomly.</span>

<span class="sd">        verbose: bool (optional, default: False)</span>
<span class="sd">            If True, enables verbose mode. Disabled by default.</span>

<span class="sd">        seed: int, None (optional, default: None)</span>
<span class="sd">            Seed for random generator.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ------------</span>

<span class="sd">        Attributes from BaseComponent</span>
<span class="sd">            Inherited by :class:`~rec.components.base_components.BaseComponent`</span>

<span class="sd">        actual_user_profiles: :obj:`numpy.ndarray`</span>
<span class="sd">            A matrix representing the *real* similarity between each item and attribute.</span>

<span class="sd">        actual_user_scores: :obj:`numpy.ndarray`</span>
<span class="sd">             A ```|U|x|I|``` matrix representing the *real* scores assigned by each user to each item, where ```|U|``` is the number of users and ```|I|``` is the number of items in the system. Item `[u, i]` is the scores assigned by user `u` to item `i`.</span>

<span class="sd">        interact_with_items: callable</span>
<span class="sd">            A function that defines user behaviors when interacting with items. If None, users follow the behavior in :meth:`get_user_feedback()`.</span>

<span class="sd">        _user_vector: **private** :obj:`numpy.ndarray`</span>
<span class="sd">            A ```|U|``` array of user indices, used internally.</span>

<span class="sd">    Raises</span>
<span class="sd">    --------</span>

<span class="sd">        TypeError</span>
<span class="sd">            If parameters are of the wrong type.</span>

<span class="sd">        ValueError</span>
<span class="sd">            If both actual_user_profiles and size are None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actual_user_profiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actual_user_scores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">interact_with_items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_users</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># general input checks</span>
        <span class="k">if</span> <span class="n">actual_user_profiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actual_user_profiles</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;actual_user_profiles must be a list or numpy.ndarray&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">interact_with_items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">interact_with_items</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;interact_with_items must be callable&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actual_user_profiles</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;actual_user_profiles and size can&#39;t both be None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actual_user_profiles</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;size must be a tuple, is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">actual_user_scores</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actual_user_scores</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;actual_user_profiles must be a list or numpy.ndarray&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actual_user_profiles</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_user_profiles</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_profiles</span> <span class="o">=</span> <span class="n">ActualUserProfiles</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">actual_user_profiles</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interact_with_items</span> <span class="o">=</span> <span class="n">interact_with_items</span>
        <span class="c1"># this will be initialized by the system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">num_users</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_user_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_users</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;actual_user_scores&#39;</span>
        <span class="n">BaseComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span><span class="p">)</span>


<div class="viewcode-block" id="Users.compute_user_scores"><a class="viewcode-back" href="../../reference/components.html#components.users.Users.compute_user_scores">[docs]</a>    <span class="k">def</span> <span class="nf">compute_user_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes and stores the actual scores that users assign to items compatible with the system. It does so by using the model&#39;s train function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ------------</span>

<span class="sd">        train_function: callable</span>
<span class="sd">            Function that is used to train the model. Since training the model corresponds to generating user scores starting from user profiles, as predicted by the model, the same function can be used to compute the real scores using the real user preferences.</span>

<span class="sd">        args, kwargs:</span>
<span class="sd">            Parameters needed by the model&#39;s train function.</span>

<span class="sd">        Raises</span>
<span class="sd">        --------</span>

<span class="sd">        TypeError</span>
<span class="sd">            If train_function is not callable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">train_function</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;train_function must be callable&quot;</span><span class="p">)</span>
        <span class="n">actual_scores</span> <span class="o">=</span> <span class="n">train_function</span><span class="p">(</span><span class="n">user_profiles</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_user_profiles</span><span class="p">,</span>
                                       <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span> <span class="o">=</span> <span class="n">actual_scores</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">actual_scores</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">store_state</span><span class="p">()</span></div>

<div class="viewcode-block" id="Users.get_actual_user_scores"><a class="viewcode-back" href="../../reference/components.html#components.users.Users.get_actual_user_scores">[docs]</a>    <span class="k">def</span> <span class="nf">get_actual_user_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an array of actual user scores.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">            user: int or numpy.ndarray or list (optional, default: None)</span>
<span class="sd">                Specifies the user index (or indices) for which to return the actual user scores. If None, the function returns the whole matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        --------</span>

<span class="sd">            An array of actual user scores for each item.</span>

<span class="sd">        Todo</span>
<span class="sd">        -------</span>

<span class="sd">        * Raise exceptions</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span><span class="p">[</span><span class="n">user</span><span class="p">,</span> <span class="p">:]</span></div>

<div class="viewcode-block" id="Users.get_user_feedback"><a class="viewcode-back" href="../../reference/components.html#components.users.Users.get_user_feedback">[docs]</a>    <span class="k">def</span> <span class="nf">get_user_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates user interactions at a given timestep, generally called by a model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ------------</span>

<span class="sd">        args, kwargs:</span>
<span class="sd">            Parameters needed by the model&#39;s train function.</span>

<span class="sd">            items: :obj:`numpy.ndarray`): A |U|x|num_items_per_iter| matrix with recommendations and</span>
<span class="sd">                new items.</span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">            Array of interactions s.t. element interactions_u(t) represents the</span>
<span class="sd">            index of the item selected by user u at time t. Shape: |U|</span>

<span class="sd">        Raises</span>
<span class="sd">        -------</span>

<span class="sd">        ValueError</span>
<span class="sd">            If :attr:`interact_with_items` is None and there is not `item` parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interact_with_items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interact_with_items</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Items can&#39;t be None&quot;</span><span class="p">)</span>
        <span class="n">reshaped_user_vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_vector</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">items</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">user_interactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span><span class="p">[</span><span class="n">reshaped_user_vector</span><span class="p">,</span> <span class="n">items</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;User scores for given items are:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_interactions</span><span class="p">))</span>
        <span class="n">sorted_user_preferences</span> <span class="o">=</span> <span class="n">user_interactions</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">interactions</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_user_vector</span><span class="p">,</span> <span class="n">sorted_user_preferences</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Users interact with the following items respectively:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> \
            <span class="nb">str</span><span class="p">(</span><span class="n">interactions</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">interactions</span></div>

    <span class="k">def</span> <span class="nf">store_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actual_user_scores</span><span class="p">))</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Elena Lucherini

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>